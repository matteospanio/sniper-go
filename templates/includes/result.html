{{define "body"}}
<div class="container-md pt-5">
    <h1>{{ if .report.Host.Name }}{{ .report.Host.Name }}{{ else }}{{.report.Host.IP }}{{end}}</h1>
    <div class="row">
        <div class="col-sm-6">
            <p>Host: {{.report.Host.Name}}</p>
        </div>
        <div class="col-sm-6">
            <p>IP: {{ range .report.Host.IP }}{{.}}, {{end}}</p>
        </div>
    </div>
    <div class="row">
        <div class="col-sm-6">
            <p>Scan started: {{.report.Date}}</p>
        </div>
        <div class="col-sm-6">
            <p>Reccurrent: No</p><!-- TODO -->
        </div>
    </div>
    <div class="row">
        <h2>Summary</h2>
        <div class="col-sm-6"/>
            <table>
                <tr>
                    <th>Critical</th>
                    <td>{{ .report.Summary.Critical }}</td>
                </tr>
                <tr>
                    <th>High</th>
                    <td>{{ .report.Summary.High }}</td>
                </tr>
                <tr>
                    <th>Medium</th>
                    <td>{{ .report.Summary.Medium }}</td>
                </tr>
                <tr>
                    <th>Low</th>
                    <td>{{ .report.Summary.Low }}</td>
                </tr>
                <tr>
                    <th>Info</th>
                    <td>{{ .report.Summary.Info }}</td>
                </tr>
            </table>
        </div>
        <div class="col-sm-6">
            <canvas data-controller="piechart" data-piechart-host-value="{{if .report.Host.Name}}{{.report.Host.Name}}{{else}}{{.report.Host.IP}}{{end}}" id="pie-chart"></canvas>
        </div>
    </div>

    <div class="row" data-controller="vulntable">
        <h2>Vulnerabilities</h2>
        <div class="card p-3 my-3">
            <table class="table table-striped table-hover" style="width:100%" data-vulntable-target="output">
                <thead>
                    <tr>
                        <th>Severity</th>
                        <th>Name</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    {{ range .report.Vulnerabilities }}
                    <tr>
                        <td>{{ .Severity }}</td>
                        <td>{{ .Name }}</td>
                        <td>{{ .Description }}</td>
                    </tr>
                    {{ end }}
                </tbody>
            </table>
        </div>
    </div>

    {{ if .report.History }}
        {{ template "history" . }}
    {{ end }}
    {{ if .report.Screens }}
        {{ template "screenshots" . }}
    {{ end }}

</div>
{{end}}

{{ define "history" }}
    <div>
        <h2>Scans History</h2>
        {{ range .report.History }}
            <p>{{ .Date }} - {{ .Target }} - {{ .Job }}</p>
        {{ end }}
    </div>
{{ end }}

{{ define "screenshots" }}
    <div>
        <h2>Screenshots</h2>
        {{ range .report.Screens }}
            <img src="{{ . }}" />
        {{ end }}
    </div>
{{ end }}